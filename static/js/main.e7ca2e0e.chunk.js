(this["webpackJsonpmevo-go"]=this["webpackJsonpmevo-go"]||[]).push([[0],{27:function(e,t,o){},30:function(e,t,o){"use strict";o.r(t);var n=o(3),i=o(1),c=o.n(i),a=o(19),s=o.n(a),r=(o(27),o(6)),l=o(9),u=o(7),d=o(12),b=o(21),j={accessToken:"pk.eyJ1IjoibWl0cmk0NSIsImEiOiJja2tqMjJ3djYwcXdpMnZxa3QydWVsYWh6In0.bS8T8wGM8SJCmouWHcJ1fA",mapInitialState:{latitude:-41.292757,longitude:174.790984,zoom:12,bearing:0,pitch:0},geolocateControl:{style:{top:80,right:10,margin:15},showAccuracyCircle:!1,positionOptions:{enableHighAccuracy:!0},fitBoundsOptions:{maxZoom:15}},navigationControl:{showCompass:!1,style:{top:0,right:10,margin:15}},layer:{zonesFadeInStyle:{id:"mevoZonesFadeIn",source:"geoDataSource",type:"fill",paint:{"fill-color":"#5B5F61","fill-outline-color":"#f7590d","fill-opacity":.3}},zonesStrokesStyles:{id:"mevoZonesStrokes",source:"geoDataSource",type:"line",paint:{"line-color":"#f7590d","line-width":3}},directionsStyles:{id:"directionJson",source:"directionJson",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#BF93E4","line-width":5}}}};function p(e){var t=e.viewport,o=e.setViewport,i=e.markersToRender,c=e.zonesToRender,a=e.setUserPosition,s=e.setLocationEnabled,l=e.directionToTheCar;return Object(n.jsxs)(u.g,Object(r.a)(Object(r.a)({},t),{},{width:"100%",height:"100%",mapStyle:"mapbox://styles/mapbox/streets-v9",onViewStateChange:function(e){return o(e)},mapboxApiAccessToken:j.accessToken,children:[c,i,l,Object(n.jsx)(u.e,Object(r.a)({},j.navigationControl)),Object(n.jsx)(u.b,Object(r.a)(Object(r.a)({},j.geolocateControl),{},{trackUserLocation:!0,onViewportChange:function(){o(Object(r.a)(Object(r.a)({},t),{},{zoom:12}))},onGeolocate:function(e){a([e.coords.longitude,e.coords.latitude]),s(!0)}}))]}))}function f(e){var t=e.clickHandler,o=e.text,c=e.locationEnabled,a=Object(i.useState)(!1),s=Object(l.a)(a,2),r=s[0],u=s[1],d="".concat(c?"cursor-pointer":"cursor-not-allowed"," relative inline-block px-6 py-2 text-base font-medium leading-6 text-center text-white uppercase transition shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none");return Object(n.jsxs)("div",{onMouseEnter:function(){return u(!r)},onMouseLeave:function(){return u(!r)},children:[Object(n.jsx)("button",{type:"button",className:d,onClick:t,disabled:!c,children:o}),!c&&r&&Object(n.jsx)("span",{className:"bg-yellow-300 border-r border-opacity-50 border-yellow-600 rounded-md shadow-md text-white w-auto h-auto absolute top-10 right-20 z-10 p-2",children:"GeoLocation should be enabled"})]})}function O(e){var t=e.findNearestCar,o=e.locationEnabled;return Object(n.jsxs)("nav",{className:"bg-mevo-main flex justify-between",children:[Object(n.jsx)("img",{className:"w-auto h-10 flex-grow-0 flex-shrink-0",src:"https://assets.mevo.co.nz/brand/logo-light.svg",alt:"Mevo Logo"}),Object(n.jsx)("div",{className:"flex justify-end flex-grow",children:Object(n.jsx)(f,{text:"Find nearest car",locationEnabled:o,clickHandler:t})})]})}function h(e){var t=e.children;return Object(n.jsx)("div",{className:"h-screen flex flex-col font-body",children:t})}p.defaultProps={setUserPosition:"",zonesToRender:{}||[],markersToRender:[]||!1,setLocationEnabled:"",directionToTheCar:{}||[]},f.defaultProps={isDisabled:!0,locationEnabled:!1},O.defaultProps={locationEnabled:!1};var m=function(){var e=Object(i.useState)(Object(r.a)({},j.mapInitialState)),t=Object(l.a)(e,2),o=t[0],c=t[1],a=Object(i.useCallback)((function(){c(Object(r.a)(Object(r.a)({},o),{},{longitude:174.790984,latitude:-41.292757,zoom:12,transitionInterpolator:new u.a({speed:1.2}),transitionDuration:"auto"}))}),[o]),s=Object(i.useState)([]),f=Object(l.a)(s,2),m=f[0],g=f[1],x=Object(i.useState)(null),v=Object(l.a)(x,2),y=(v[0],v[1]),w=Object(i.useState)(null),S=Object(l.a)(w,2),k=(S[0],S[1]),N=Object(i.useState)([]),T=Object(l.a)(N,2),C=T[0],z=T[1],E=Object(i.useState)([]),I=Object(l.a)(E,2),J=I[0],M=I[1],P=Object(i.useState)([]),L=Object(l.a)(P,2),A=L[0],F=L[1],R=Object(i.useState)(!1),U=Object(l.a)(R,2),D=U[0],V=U[1],W=Object(i.useState)([]),B=Object(l.a)(W,2),G=B[0],H=B[1];return Object(i.useEffect)((function(){fetch("https://api.mevo.co.nz/public/home-zones/all").then((function(e){return e.json()})).then((function(e){g(Object(n.jsxs)(u.f,{type:"geojson",data:e.data,id:"geoDataSource",children:[Object(n.jsx)(u.c,Object(r.a)({},j.layer.zonesFadeInStyle)),Object(n.jsx)(u.c,Object(r.a)({},j.layer.zonesStrokesStyles))]}))}),(function(e){y(e)}))}),[]),Object(i.useEffect)((function(){fetch("https://api.mevo.co.nz/public/vehicles/all").then((function(e){return e.json()})).then((function(e){z(e),M(e.map((function(e){return Object(n.jsx)(u.d,{longitude:Number(e.position.longitude),latitude:Number(e.position.latitude),offsetTop:-44,children:Object(n.jsx)("img",{src:e.iconUrl,alt:"Mevo car position",className:"w-8 h-auto"})},e.position.longitude+e.position.latitude)})))}),(function(e){k(e)}))}),[]),Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(h,{children:[Object(n.jsx)(O,{locationEnabled:D,backToWelly:a,findNearestCar:function(){var e=[];C.map((function(t){return e.push(Object(d.point)([Number(t.position.longitude),Number(t.position.latitude)]))}));var t=Object(d.nearestPoint)(Object(d.point)(A),Object(d.featureCollection)(e)),o=C.find((function(e){return e.position.longitude==t.geometry.coordinates[0]&&e.position.latitude==t.geometry.coordinates[1]}));if(o){M(Object(n.jsx)(u.d,{longitude:Number(o.position.longitude),latitude:Number(o.position.latitude),offsetTop:-44,children:Object(n.jsx)("img",{src:o.iconUrl,alt:"Nearest Mevo car position",className:"animate-car-found w-10 h-auto "})}));var i="https://api.mapbox.com/directions/v5/mapbox/walking/".concat(A,";").concat(t.geometry.coordinates,"?access_token=").concat(j.accessToken);fetch(i).then((function(e){return e.json()})).then((function(e){var t=b.toGeoJSON(e.routes[0].geometry);H(Object(n.jsx)(u.f,{type:"geojson",data:t,id:"directionJson",children:Object(n.jsx)(u.c,Object(r.a)({},j.layer.directionsStyles))}));var o=t.coordinates[0],i=t.coordinates[t.coordinates.length-1];console.log(t),console.log(o),console.log(i)}),(function(e){console.log(e)}))}}}),Object(n.jsx)(p,{viewport:o,setViewport:c,userPosition:A,setUserPosition:F,setLocationEnabled:V,zonesToRender:m,markersToRender:J,directionToTheCar:G})]})})};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(m,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.e7ca2e0e.chunk.js.map