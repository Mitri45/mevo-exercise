(this["webpackJsonpmevo-go"]=this["webpackJsonpmevo-go"]||[]).push([[0],{27:function(e,t,o){},30:function(e,t,o){"use strict";o.r(t);var n=o(3),i=o(1),a=o.n(i),c=o(19),s=o.n(c),r=(o(27),o(6)),l=o(9),u=o(7),d=o(12),b=o(21),j={accessToken:"pk.eyJ1IjoibWl0cmk0NSIsImEiOiJja2tqMjJ3djYwcXdpMnZxa3QydWVsYWh6In0.bS8T8wGM8SJCmouWHcJ1fA",mapInitialState:{latitude:-41.292757,longitude:174.790984,zoom:12,bearing:0,pitch:0},geolocateControl:{style:{top:80,right:10,margin:15},showAccuracyCircle:!1,positionOptions:{enableHighAccuracy:!0},fitBoundsOptions:{maxZoom:15}},navigationControl:{showCompass:!1,style:{top:0,right:10,margin:15}},layer:{zonesFadeInStyle:{id:"mevoZonesFadeIn",source:"geoDataSource",type:"fill",paint:{"fill-color":"#5B5F61","fill-outline-color":"#f7590d","fill-opacity":.3}},zonesStrokesStyles:{id:"mevoZonesStrokes",source:"geoDataSource",type:"line",paint:{"line-color":"#f7590d","line-width":3}},directionsStyles:{id:"directionJson",source:"directionJson",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#BF93E4","line-width":5}}}};function p(e){var t=e.viewport,o=e.setViewport,i=e.markersToRender,a=e.zonesToRender,c=e.setUserPosition,s=e.setLocationEnabled,l=e.directionToTheCar;return Object(n.jsxs)(u.h,Object(r.a)(Object(r.a)({},t),{},{width:"100%",height:"100%",mapStyle:"mapbox://styles/mapbox/streets-v9",onViewStateChange:o,mapboxApiAccessToken:j.accessToken,children:[a,i,l,Object(n.jsx)(u.e,Object(r.a)({},j.navigationControl)),Object(n.jsx)(u.b,Object(r.a)(Object(r.a)({},j.geolocateControl),{},{trackUserLocation:!0,onViewportChange:function(){o(Object(r.a)(Object(r.a)({},t),{},{zoom:12}))},onGeolocate:function(e){c([e.coords.longitude,e.coords.latitude]),s(!0)}}))]}))}function O(e){var t=e.clickHandler,o=e.text,a=e.locationEnabled,c=Object(i.useState)(!1),s=Object(l.a)(c,2),r=s[0],u=s[1],d="".concat(a?"cursor-pointer":"cursor-not-allowed"," relative inline-block px-6 py-2 text-base font-medium leading-6 text-center text-white uppercase transition shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none");return Object(n.jsxs)("div",{onMouseEnter:function(){return u(!r)},onMouseLeave:function(){return u(!r)},children:[Object(n.jsx)("button",{type:"button",className:d,onClick:t,disabled:!a,children:o}),!a&&r&&Object(n.jsx)("span",{className:"bg-yellow-300 border-r border-opacity-50 border-yellow-600 rounded-md shadow-md text-white w-auto h-auto absolute top-10 right-20 z-10 p-2",children:"GeoLocation should be enabled"})]})}function h(e){var t=e.findNearestCar,o=e.locationEnabled;return Object(n.jsxs)("nav",{className:"bg-mevo-main flex justify-between",children:[Object(n.jsx)("img",{className:"w-auto h-10 flex-grow-0 flex-shrink-0",src:"https://assets.mevo.co.nz/brand/logo-light.svg",alt:"Mevo Logo"}),Object(n.jsx)("div",{className:"flex justify-end flex-grow",children:Object(n.jsx)(O,{text:"Find nearest car",locationEnabled:o,clickHandler:t})})]})}function f(e){var t=e.children;return Object(n.jsx)("div",{className:"h-screen flex flex-col font-body",children:t})}p.defaultProps={setUserPosition:"",zonesToRender:{}||[],markersToRender:[]||!1,setLocationEnabled:"",directionToTheCar:{}||[]},O.defaultProps={isDisabled:!0,locationEnabled:!1},h.defaultProps={locationEnabled:!1};var m=function(){var e=Object(i.useState)(Object(r.a)({},j.mapInitialState)),t=Object(l.a)(e,2),o=t[0],a=t[1],c=Object(i.useCallback)((function(){a(Object(r.a)(Object(r.a)({},o),{},{longitude:174.790984,latitude:-41.292757,zoom:12,transitionInterpolator:new u.a({speed:1.2}),transitionDuration:"auto"}))}),[o]),s=Object(i.useState)([]),O=Object(l.a)(s,2),m=O[0],g=O[1],x=Object(i.useState)(null),v=Object(l.a)(x,2),y=(v[0],v[1]),w=Object(i.useState)(null),S=Object(l.a)(w,2),k=(S[0],S[1]),N=Object(i.useState)([]),T=Object(l.a)(N,2),z=T[0],C=T[1],E=Object(i.useState)([]),I=Object(l.a)(E,2),J=I[0],M=I[1],P=Object(i.useState)([]),L=Object(l.a)(P,2),A=L[0],D=L[1],F=Object(i.useState)(!1),R=Object(l.a)(F,2),U=R[0],B=R[1],V=Object(i.useState)([]),W=Object(l.a)(V,2),G=W[0],H=W[1];return Object(i.useEffect)((function(){fetch("https://api.mevo.co.nz/public/home-zones/all").then((function(e){return e.json()})).then((function(e){g(Object(n.jsxs)(u.f,{type:"geojson",data:e.data,id:"geoDataSource",children:[Object(n.jsx)(u.c,Object(r.a)({},j.layer.zonesFadeInStyle)),Object(n.jsx)(u.c,Object(r.a)({},j.layer.zonesStrokesStyles))]}))}),(function(e){y(e)}))}),[]),Object(i.useEffect)((function(){fetch("https://api.mevo.co.nz/public/vehicles/all").then((function(e){return e.json()})).then((function(e){C(e),M(e.map((function(e){return Object(n.jsx)(u.d,{longitude:Number(e.position.longitude),latitude:Number(e.position.latitude),children:Object(n.jsx)("img",{src:e.iconUrl,alt:"Mevo car position",className:"w-8 h-auto"})},e.position.longitude+e.position.latitude)})))}),(function(e){k(e)}))}),[]),Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(f,{children:[Object(n.jsx)(h,{locationEnabled:U,backToWelly:c,findNearestCar:function(){var e=[];z.map((function(t){return e.push(Object(d.point)([Number(t.position.longitude),Number(t.position.latitude)]))}));var t=Object(d.nearestPoint)(Object(d.point)(A),Object(d.featureCollection)(e)),i=z.find((function(e){return e.position.longitude==t.geometry.coordinates[0]&&e.position.latitude==t.geometry.coordinates[1]}));if(i){M([Object(n.jsx)(u.d,{longitude:Number(i.position.longitude),latitude:Number(i.position.latitude),children:Object(n.jsx)("img",{src:i.iconUrl,alt:"Mevo car position",className:"w-10 h-auto"})},i.position.longitude+i.position.latitude)]);var c="https://api.mapbox.com/directions/v5/mapbox/walking/".concat(A,";").concat(t.geometry.coordinates,"?access_token=").concat(j.accessToken);fetch(c).then((function(e){return e.json()})).then((function(e){var t=b.toGeoJSON(e.routes[0].geometry);H(Object(n.jsx)(u.f,{type:"geojson",data:t,id:"directionJson",children:Object(n.jsx)(u.c,Object(r.a)({},j.layer.directionsStyles))})),console.log(e);var i=t.coordinates[0],c=t.coordinates[t.coordinates.length-1];console.log(t.coordinates),console.log(i),console.log(c);var s=new u.g(o).fitBounds([i,c]),l=s.latitude,d=s.longitude,p=s.zoom;a(Object(r.a)(Object(r.a)({},o),{},{longitude:d,latitude:l,zoom:p,transitionInterpolator:new u.a,transitionDuration:"auto"}))}),(function(e){console.log(e)}))}}}),Object(n.jsx)(p,{viewport:o,setViewport:a,userPosition:A,setUserPosition:D,setLocationEnabled:B,zonesToRender:m,markersToRender:J,directionToTheCar:G})]})})};s.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(m,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.1d93fcdc.chunk.js.map